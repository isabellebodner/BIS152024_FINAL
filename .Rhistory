knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(dplyr)
spills <- read_csv("Spill_Incidents.csv")
View(spills)
oil_spills <- read_csv("Oil_Spill_Incident_Tracking_[ds394] (1).csv")
View(oil_spills)
glimpse(oil_spills)
oil_spills %>%
count(LOCALECOUN)
oil_spills %>%
count(LOCALECOUN) %>%
arrange(desc())
oil_spills %>%
count(LOCALECOUN)
oil_spills %>%
count(LOCALECOUN) %>%
arrange(-n)
oil_spills %>%
select(LATITUDE,LONGITUDE)
oil_spills %>%
select(LATITUDE,LONGITUDE) %>%
summary()
lat <- c(31.99,41.97)
long <- c(-124.2,-114.6)
library(ggmap)
register_stadiamaps("04b361f0-91cd-4a47-9b3f-943a88c13591", write = FALSE)
bbox <- make_bbox(long,lat, f=0.03)
map1 <- get_stadiamap(bbox, maptype = "stamen_terrain", zoom = 4)
ggmap(map1)
ggmap(map1)+
geom_point(data = oil_spills, aes(long,lat), size=1)
ggmap(map1)+
geom_point(data = oil_spills, aes(long, lat), size=1)
ggmap(map1)+
geom_point(data = oil_spills, aes(lat, long), size=1)
ggmap(map1)+
geom_point(data = oil_spills, aes(long, lat), size=1)
ggmap(map1)+
geom_point(data = oil_spills)
ggmap(map1)+
geom_point(data = oil_spills, aes(long, lat))
ggmap(map1)+
geom_point(data = oil_spills, aes(long, lat), size=0.5)
ggmap(map1)+
geom_point(data = oil_spills, aes(long, lat), size=0.1)
ggmap(map1)+
geom_point(data = oil_spills, aes(long, lat), size=0.3)
anyNA(oil_spills)
library(naniar)
miss_var_summary(oil_spills)
ggmap(map1)+
geom_point(data = oil_spills, aes(x= long, y= lat), size=0.3)
ggmap(map1)+
geom_point(data = oil_spills, aes(LONGITUDE, LATITUDE), size=0.3)
ggmap(map1)+
geom_point(data = oil_spills, aes(LONGITUDE, LATITUDE, fill=LOCALECOUN), size=0.3)
ggmap(map1)+
geom_point(data = oil_spills, aes(LONGITUDE, LATITUDE, color=LOCALECOUN), size=0.3)
ggmap(map1)+
geom_point(data = oil_spills, aes(LONGITUDE, LATITUDE), size=0.3)+
labs(title = "Oil Spills in California",
x= "Longitude",
y= "Latitude")
oil_spills %>%
filter(DATEOFINCI)
oil_spills %>%
select(DATEOFINCI)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(naniar)
library(ggplot2)
age <- read_csv("age.csv")
race <- read_csv("race.csv")
glimpse(age)
glimpse(race)
age %>%
group_by(CALENDAR_YEAR, LOCATION) %>%
mutate(EXPERIENCING_HOMELESSNESS_CNT=as.integer(EXPERIENCING_HOMELESSNESS_CNT)) %>%
summarise(total_homeless=sum(EXPERIENCING_HOMELESSNESS_CNT, na.rm = TRUE)) %>%
arrange(desc(total_homeless))
age %>%
group_by(LOCATION) %>%
filter(LOCATION!="California") %>%
mutate(EXPERIENCING_HOMELESSNESS_CNT=as.integer(EXPERIENCING_HOMELESSNESS_CNT)) %>%
summarise(total_homeless=sum(EXPERIENCING_HOMELESSNESS_CNT, na.rm = TRUE)) %>%
arrange(desc(total_homeless))
age %>%
group_by(CALENDAR_YEAR) %>%
mutate(EXPERIENCING_HOMELESSNESS_CNT=as.integer(EXPERIENCING_HOMELESSNESS_CNT)) %>%
summarise(total_homeless=sum(EXPERIENCING_HOMELESSNESS_CNT, na.rm = TRUE)) %>%
arrange(desc(total_homeless))
age %>%
group_by(CALENDAR_YEAR) %>%
mutate(CALENDAR_YEAR=as.factor(CALENDAR_YEAR)) %>%
mutate(EXPERIENCING_HOMELESSNESS_CNT=as.integer(EXPERIENCING_HOMELESSNESS_CNT)) %>%
summarise(total_homeless=sum(EXPERIENCING_HOMELESSNESS_CNT, na.rm = TRUE)) %>%
ggplot(aes(x=CALENDAR_YEAR, y=total_homeless))+
geom_col(color="black", fill="blue", alpha=0.6)+
labs(title = "Total Homeless Count 2017-2023",
x= "Year",
y= "Count")
View(age)
View(race)
merged <- merge(age, race, by = "LOCATION_ID")
View(merged)
class(age$AGE_GROUP_PUBLIC)
summarry(age$AGE_GROUP_PUBLIC)
summary(age$AGE_GROUP_PUBLIC)
summarise(age$AGE_GROUP_PUBLIC)
table(age$AGE_GROUP_PUBLIC)
age_grouped <- age %>%
filter(AGE_GROUP_PUBLIC!="Unkown") %>%
mutate(age_group = case_when(
AGE_GROUP_PUBLIC == "Under 18" ~ "<18",
AGE_GROUP_PUBLIC == "18-24" ~ "18-24",
AGE_GROUP_PUBLIC == "25-34" ~ "25-34",
AGE_GROUP_PUBLIC == "35-44" ~ "35-44",
AGE_GROUP_PUBLIC == "45-54" ~ "45-54",
AGE_GROUP_PUBLIC == "55-64" ~ "55-64",
AGE_GROUP_PUBLIC == "65+" ~ ">65"))
head(age_grouped)
View(age_grouped)
age_grouped <- age %>%
filter(AGE_GROUP_PUBLIC!="Unkown") %>%
mutate(age_group = case_when(
AGE_GROUP_PUBLIC == "Under 18" ~ "<18",
AGE_GROUP_PUBLIC == "18-24" ~ "18-24",
AGE_GROUP_PUBLIC == "25-34" ~ "25-34",
AGE_GROUP_PUBLIC == "35-44" ~ "35-44",
AGE_GROUP_PUBLIC == "45-54" ~ "45-54",
AGE_GROUP_PUBLIC == "55-64" ~ "55-64",
AGE_GROUP_PUBLIC == "65+" ~ ">65")) %>%
filter(age_group!="NA")
head(age_grouped)
View(merged)
merged <- bind_rows(age_grouped, race)
bind <- bind_rows(age_grouped, race)
View(bind)
merged <- merge(age_grouped, race, by = "LOCATION_ID")
View(merged)
bruh <- merge(age_grouped, race, by = "LOCATION_ID")
age_grouped %>%
group_by(age_group) %>%
mutate(EXPERIENCING_HOMELESSNESS_CNT=as.integer(EXPERIENCING_HOMELESSNESS_CNT)) %>%
summarise(total_homeless=sum(EXPERIENCING_HOMELESSNESS_CNT, na.rm = TRUE))
age_grouped %>%
group_by(age_group) %>%
mutate(EXPERIENCING_HOMELESSNESS_CNT=as.integer(EXPERIENCING_HOMELESSNESS_CNT)) %>%
summarise(total_homeless=sum(EXPERIENCING_HOMELESSNESS_CNT, na.rm = TRUE)) %>%
ggplot(aes(x=age_group, y=total_homeless))+
geom_col()
age_grouped %>%
group_by(age_group) %>%
mutate(EXPERIENCING_HOMELESSNESS_CNT=as.integer(EXPERIENCING_HOMELESSNESS_CNT)) %>%
summarise(total_homeless=sum(EXPERIENCING_HOMELESSNESS_CNT, na.rm = TRUE)) %>%
ggplot(aes(x=age_group, y=total_homeless, fill=age_group))+
geom_col()
age_grouped %>%
group_by(age_group) %>%
mutate(EXPERIENCING_HOMELESSNESS_CNT=as.integer(EXPERIENCING_HOMELESSNESS_CNT)) %>%
summarise(total_homeless=sum(EXPERIENCING_HOMELESSNESS_CNT, na.rm = TRUE)) %>%
ggplot(aes(x=age_group, y=total_homeless))+
geom_col(color="magenta". fill="black", alpha=0.5)
age_grouped %>%
group_by(age_group) %>%
mutate(EXPERIENCING_HOMELESSNESS_CNT=as.integer(EXPERIENCING_HOMELESSNESS_CNT)) %>%
summarise(total_homeless=sum(EXPERIENCING_HOMELESSNESS_CNT, na.rm = TRUE)) %>%
ggplot(aes(x=age_group, y=total_homeless))+
geom_col(color="magenta", fill="black", alpha=0.5)
age_grouped %>%
group_by(age_group) %>%
mutate(EXPERIENCING_HOMELESSNESS_CNT=as.integer(EXPERIENCING_HOMELESSNESS_CNT)) %>%
summarise(total_homeless=sum(EXPERIENCING_HOMELESSNESS_CNT, na.rm = TRUE)) %>%
ggplot(aes(x=age_group, y=total_homeless))+
geom_col(color="black", fill="magenta", alpha=0.5)
age_grouped %>%
group_by(age_group) %>%
mutate(EXPERIENCING_HOMELESSNESS_CNT=as.integer(EXPERIENCING_HOMELESSNESS_CNT)) %>%
summarise(total_homeless=sum(EXPERIENCING_HOMELESSNESS_CNT, na.rm = TRUE)) %>%
ggplot(aes(x=age_group, y=total_homeless))+
geom_col(color="black", fill="magenta", alpha=0.5)+
labs(title = "Total Homelessness by Age Group",
x= "Age Group",
y= "Total Count")
age %>%
group_by(CALENDAR_YEAR) %>%
mutate(CALENDAR_YEAR=as.factor(CALENDAR_YEAR)) %>%
mutate(EXPERIENCING_HOMELESSNESS_CNT=as.integer(EXPERIENCING_HOMELESSNESS_CNT)) %>%
summarise(total_homeless=sum(EXPERIENCING_HOMELESSNESS_CNT, na.rm = TRUE)) %>%
ggplot(aes(x=CALENDAR_YEAR, y=total_homeless))+
geom_col(color="black", fill="blue", alpha=0.6)+
labs(title = "Total Homeless Count 2017-2023",
x= "Year",
y= "Total Count")
age_grouped %>%
group_by(age_group, LOCATION) %>%
mutate(EXPERIENCING_HOMELESSNESS_CNT=as.integer(EXPERIENCING_HOMELESSNESS_CNT)) %>%
summarise(total_homeless=sum(EXPERIENCING_HOMELESSNESS_CNT, na.rm = TRUE))
age_grouped %>%
group_by(age_group, LOCATION) %>%
mutate(EXPERIENCING_HOMELESSNESS_CNT=as.integer(EXPERIENCING_HOMELESSNESS_CNT)) %>%
summarise(total_homeless=sum(EXPERIENCING_HOMELESSNESS_CNT, na.rm = TRUE)) %>%
arrange(desc(total_homeless))
age_grouped %>%
filter(LOCATION!="California") %>%
group_by(age_group, LOCATION) %>%
mutate(EXPERIENCING_HOMELESSNESS_CNT=as.integer(EXPERIENCING_HOMELESSNESS_CNT)) %>%
summarise(total_homeless=sum(EXPERIENCING_HOMELESSNESS_CNT, na.rm = TRUE)) %>%
arrange(desc(total_homeless))
age_grouped %>%
filter(LOCATION!="California") %>%
group_by(age_group, LOCATION) %>%
mutate(EXPERIENCING_HOMELESSNESS_CNT=as.integer(EXPERIENCING_HOMELESSNESS_CNT)) %>%
summarise(total_homeless=sum(EXPERIENCING_HOMELESSNESS_CNT, na.rm = TRUE)) %>%
arrange(desc(total_homeless)) %>%
ggplot(aes(x=age_group, y=total_homeless))+
geom_col()+
facet_wrap(~LOCATION, scales = "free")
install.packages("shiny")
library(shiny)
install.packages("shinydashboard")
library(shinydashboard)
library(shinydashboard)
age_grouped %>%
filter(LOCATION!="California") %>%
group_by(age_group, LOCATION) %>%
mutate(EXPERIENCING_HOMELESSNESS_CNT=as.integer(EXPERIENCING_HOMELESSNESS_CNT)) %>%
summarise(total_homeless=sum(EXPERIENCING_HOMELESSNESS_CNT),
average_homeless=mean(EXPERIENCING_HOMELESSNESS_CNT, na.rm = TRUE)) %>%
arrange(desc(total_homeless)) %>%
ggplot(aes(x=age_group, y=total_homeless))+
geom_col()+
facet_wrap(~LOCATION, scales = "free")
age_grouped %>%
filter(LOCATION!="California") %>%
group_by(age_group, LOCATION) %>%
mutate(EXPERIENCING_HOMELESSNESS_CNT=as.integer(EXPERIENCING_HOMELESSNESS_CNT)) %>%
summarise(total_homeless=sum(EXPERIENCING_HOMELESSNESS_CNT, na.rm = TRUE),
average_homeless=mean(EXPERIENCING_HOMELESSNESS_CNT, na.rm = TRUE)) %>%
arrange(desc(total_homeless)) %>%
ggplot(aes(x=age_group, y=total_homeless))+
geom_col()+
facet_wrap(~LOCATION, scales = "free")
